<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <link rel="alternate icon" type="image/png" href="/img/favicon.png">
    <title>jjppp | Blog of jjppp</title>
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/markdown.css">

    
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">jjppp</a>
    <a class="go-home" href="/">
        <svg width="8" height="14" viewBox="0 0 8 14">
            <path d="M7 1L1 7l6 6" stroke="#000" stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </a>
</div>
                
                <div class="post-main">

    
        <div class="post-main-title">
            计算方法6 FFT
        </div>
        <div class="post-meta">
            2022-06-14
        </div>
    

    
      
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    
    
    <div class="post-md">
        <h1 id="多项式的表示"><a href="#多项式的表示" class="headerlink" title="多项式的表示"></a>多项式的表示</h1><p>最熟悉的是系数表示法，例如 $P(x)&#x3D;\sum_{i&#x3D;0}^n a_i x^i$</p>
<p>系数表示法有它的好处：例如将 $\Set{1,x,x^2\ldots}$ 视为一组基时，系数恰好就是多项式在这组基下的坐标；例如对于任给的点 $x$<br>可以计算多项式的值（$O(n)$ 次乘法）。但是在给出系数表示法后，对两个 $n$ 次多项式很难高效算乘积（还记得天才本科生Karatsuba吗）</p>
<p>还可以是点值表示法。根据lagrange插值可知，一个 $n$ 次多项式可以由 $n+1$ 个点唯一确定。因此<br>$P(x)\overset{\text{def} }&#x3D; \Set{(x_0,y_0),(x_1,y_1)\ldots}$</p>
<p>此时计算 $P(x)Q(x)$ 只需要求出 $2n+1$ 个点值，然后将这些取值对应相乘即可得到 $R(x)&#x3D;P(x)Q(x)$ 的点值，也就唯一确定了<br>$R(x)$</p>
<p>因此我们希望有一种方法，对于给定的系数表示多项式 $F(x),G(x)$，能够选取 $2n+1$ 个点</p>
<p>对这 $2n+1$ 个点做插值后得到 $F^*(x),G^*(x)$ 的点值表示，相乘最后还原得到 $F(x)G(x)$ 的系数表示。</p>
<p>这就是FFT</p>
<h1 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h1><h2 id="DFT"><a href="#DFT" class="headerlink" title="DFT"></a>DFT</h2><p>不妨假设多项式是 $n&#x3D;2^k$ 次的</p>
<p>考虑方程 $x^n&#x3D;1$ 的所有复数解，它们构成了复平面单位圆上等距分布的 $n$ 个点，记为 $\Set{\omega_i\mid<br>\omega_i^n&#x3D;1}$</p>
<p>选择这些点出自如下考虑：取 $\Omega_n$，那么有 ${\Omega_{2n} }^2\overset{\text{def}<br>}&#x3D;\Set{x^2\mid x\in \Omega_{2n} }&#x3D;\Omega_n$。这暗示我们可以通过类似分治的算法来每次将问题的规模减小一半。并且对于<br>$\Omega_n$ 而言，只需要其生成元 $\omega_1&#x3D;e^{\frac{2\pi}{n+1}i}$ 即可完全表示。</p>
<p>假设需要对 $F(x)&#x3D;\sum_{i&#x3D;0}^{2n} a_ix^i$ 插值，那么记 $G(x)&#x3D;\sum_{i&#x3D;0}^{n}<br>a_{2i}x^{i}$，$H(x)&#x3D;\sum_{i&#x3D;0}^n a_{2i+1}x^{i}$，显然有</p>
<ol>
<li><p>$F(x)&#x3D;G(x^2)+xH(x^2)$</p>
</li>
<li><p>原本要对 $F(x)$ 在 $\Omega_{2n}$ 上插值，现在要对 $G(x),H(x)$ 在 $\Omega_n$ 上插值</p>
</li>
</ol>
<p>主定理算一下就是 $O(n\log n)$ 的。</p>
<h2 id="IDFT"><a href="#IDFT" class="headerlink" title="IDFT"></a>IDFT</h2><p>考虑如下矩阵形式的DFT</p>
<p>$$<br>\begin{bmatrix}<br>\omega^0 &amp; \omega^0 &amp; \cdots &amp; \omega^0<br>\<br>\omega^0 &amp; \omega^1 &amp; \cdots &amp; \omega^n<br>\<br>\vdots   &amp; \vdots   &amp; \ddots &amp; \vdots<br>\<br>\omega^0 &amp; \omega^n &amp; \cdots &amp; \omega^{n^2}<br>\end{bmatrix}<br>\begin{bmatrix}<br>a_0 \ a_1 \ \vdots \ a_n<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>F(\omega^0) \ F(\omega^1) \ \vdots \ F(\omega^n)<br>\end{bmatrix}<br>$$</p>
<p>即我们的 $\Omega_n$ 是一组基，$\Set{a_n}$ 则是基下的坐标，作用一下就能得到多项式在 $\Omega_n$ 上的点值。</p>
<p>这个矩阵 $W$ 非常经典，算一下行列式和逆就会发现对于IDFT的操作只需要取 $\omega_1’&#x3D;-\omega_1$<br>做DFT即可实现逆变换，最后需要除掉一个系数 $\frac{1}{n+1}$</p>
<p>据助教说不考这么麻烦的计算，我就摸了 # 多项式的表示 最熟悉的是系数表示法，例如 $P(x)&#x3D;\sum_{i&#x3D;0}^n a_i x^i$ 系数表示法有它的好处：例如将 $\Set{1,x,x^2\ldots}$ 视为一组基时，系数恰好就是多项式在这组基下的坐标；例如对于任给的点 $x$ 可以计算多项式的值（$O(n)$ 次乘法）。但是在给出系数表示法后，对两个 $n$ 次多项式很难高效算乘积（还记得天才本科生Karatsuba吗） 还可以是点值表示法。根据lagrange插值可知，一个 $n$ 次多项式可以由 $n+1$ 个点唯一确定。因此 $P(x)\overset{\text{def} }&#x3D; \Set{(x_0,y_0),(x_1,y_1)\ldots}$ 此时计算 $P(x)Q(x)$ 只需要求出 $2n+1$ 个点值，然后将这些取值对应相乘即可得到 $R(x)&#x3D;P(x)Q(x)$ 的点值，也就唯一确定了 $R(x)$ 因此我们希望有一种方法，对于给定的系数表示多项式 $F(x),G(x)$，能够选取 $2n+1$ 个点 对这 $2n+1$ 个点做插值后得到 $F^*(x),G^*(x)$ 的点值表示，相乘最后还原得到 $F(x)G(x)$ 的系数表示。 这就是FFT # FFT ## DFT 不妨假设多项式是 $n&#x3D;2^k$ 次的 考虑方程 $x^n&#x3D;1$ 的所有复数解，它们构成了复平面单位圆上等距分布的 $n$ 个点，记为 $\Set{\omega_i\mid \omega_i^n&#x3D;1}$ 选择这些点出自如下考虑：取 $\Omega_n$，那么有 ${\Omega_{2n} }^2\overset{\text{def} }&#x3D;\Set{x^2\mid x\in \Omega_{2n} }&#x3D;\Omega_n$。这暗示我们可以通过类似分治的算法来每次将问题的规模减小一半。并且对于 $\Omega_n$ 而言，只需要其生成元 $\omega_1&#x3D;e^{\frac{2\pi}{n+1}i}$ 即可完全表示。 假设需要对 $F(x)&#x3D;\sum_{i&#x3D;0}^{2n} a_ix^i$ 插值，那么记 $G(x)&#x3D;\sum_{i&#x3D;0}^{n} a_{2i}x^{i}$，$H(x)&#x3D;\sum_{i&#x3D;0}^n a_{2i+1}x^{i}$，显然有 1. $F(x)&#x3D;G(x^2)+xH(x^2)$ 2. 原本要对 $F(x)$ 在 $\Omega_{2n}$ 上插值，现在要对 $G(x),H(x)$ 在 $\Omega_n$ 上插值 主定理算一下就是 $O(n\log n)$ 的。 ## IDFT 考虑如下矩阵形式的DFT $$ \begin{bmatrix} \omega^0 &amp; \omega^0 &amp; \cdots &amp; \omega^0 \\ \omega^0 &amp; \omega^1 &amp; \cdots &amp; \omega^n \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \omega^0 &amp; \omega^n &amp; \cdots &amp; \omega^{n^2} \end{bmatrix} \begin{bmatrix} a_0 \\ a_1 \\ \vdots \\ a_n \end{bmatrix} &#x3D; \begin{bmatrix} F(\omega^0) \\ F(\omega^1) \\ \vdots \\ F(\omega^n) \end{bmatrix} $$ 即我们的 $\Omega_n$ 是一组基，$\Set{a_n}$ 则是基下的坐标，作用一下就能得到多项式在 $\Omega_n$ 上的点值。 这个矩阵 $W$ 非常经典，算一下行列式和逆就会发现对于IDFT的操作只需要取 $\omega_1’&#x3D;-\omega_1$ 做DFT即可实现逆变换，最后需要除掉一个系数 $\frac{1}{n+1}$</p>
<!-- more -->

    </div>

</div>

                <div class="footer">
    <span>Copyright © 2022 jjppp</span>
    <span>Theme Designed By <a target="_blank" href="https://zheli.design/one-paper">這Li</a></span>
</div>


<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>